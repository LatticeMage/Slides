<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/assets/css/style.css?v=2de2fbe143f50755247818f2425fc5a669be9e5e">
  <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>表格測試 | Slides</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="表格測試" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="“Slides of LatticeMage/PosetMage”" />
<meta property="og:description" content="“Slides of LatticeMage/PosetMage”" />
<link rel="canonical" href="http://localhost:4001/AI/%E8%A1%A8%E6%A0%BC%E6%B8%AC%E8%A9%A6.html" />
<meta property="og:url" content="http://localhost:4001/AI/%E8%A1%A8%E6%A0%BC%E6%B8%AC%E8%A9%A6.html" />
<meta property="og:site_name" content="Slides" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="表格測試" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"“Slides of LatticeMage/PosetMage”","headline":"表格測試","url":"http://localhost:4001/AI/%E8%A1%A8%E6%A0%BC%E6%B8%AC%E8%A9%A6.html"}</script>
<!-- End Jekyll SEO tag -->

  <style>
    .container {
      display: flex;
    }

    .sidebar {
      position: fixed;
      width: 150px; /* Reduced from 200px */
      padding: 1em;
      overflow: auto;
      height: 100vh;
    }

    .content {
      margin-left: 200px; /* Reduced from 210px */
    }

    /* Reduced line height and spacing for ToC items */
    .sidebar p {
      margin: 0;
      padding: 0;
      line-height: 1.2em;
    }
  </style>
</head>

<body>
  <header>
    <div class="container">
      <a id="a-title" href="/">
        <h1>Slides</h1>
      </a>
      <h2>"Slides of LatticeMage/PosetMage"</h2>

      <section id="downloads">
        
        <a href="https://github.com/latticemage/Slides" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
      </section>
    </div>
  </header>

  <div class="container">
    <div class="sidebar" id="toc"></div>
    <div class="content">
      <section id="main_content">
        <h1 id="表格測試">表格測試</h1>

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<h2 id="上傳">上傳</h2>
<div id="upload-file">
  <p><input type="file" id="xlsxFile" accept=".xlsx" onchange="uploadFile()" /></p>
</div>

<h2 id="列印每頁標題與行數">列印每頁標題與行數</h2>
<div id="worksheetsInfo"></div>

<h2 id="列印所有內容">列印所有內容</h2>
<div id="worksheetsTest"></div>

<script>
// Global variable
let workbook;

// Define helper functions
function uploadFile(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = function(e) {
            resolve(new Uint8Array(e.target.result));
        };
        reader.onerror = reject;
        reader.readAsArrayBuffer(file);
    });
}

function parseXLSX(data) {
    return XLSX.read(data, {type: 'array'});
}

async function uploadParseXLSX() {
    const xlsxFile = document.getElementById('xlsxFile').files[0];
    if (!xlsxFile) {
        alert('No file selected!');
        return;
    }

    const data = await uploadFile(xlsxFile);
    workbook = parseXLSX(data);

    return workbook.Sheets;  // Return sheets for the printInfo function
}

function createDict(sheetTranslate) {
    let dict = {};

    // Loop through each line in the translation sheet
    sheetTranslate.forEach((line, index) => {
        if (index === 0) return;  // Skip header

        // Line format: [type, en, zh, ...]

        let type = line[0];  // First column is the type

        // Loop through each language in the line, starting from the 2nd column
        for(let j=1; j<line.length; j++){
            let lang = sheetTranslate[0][j];  // Get language from header
            let text = line[j];  // Get corresponding text

            // Initialize language dict if not present
            if (!dict[lang]) dict[lang] = {};

            if (type) {
                // If type is present, create new question entry
                dict[lang][text] = { type, ans: [], ansnum: {} };
            } else {
                // If type is not present, append to answer array of the most recent question
                let recentQuestionKey = Object.keys(dict[lang])[Object.keys(dict[lang]).length - 1];
                dict[lang][recentQuestionKey].ans.push(text);
                dict[lang][recentQuestionKey].ansnum[text] = dict[lang][recentQuestionKey].ans.length;
            }
        }
    });

    return dict;
}

function printInfo(sheets) {
    const worksheetsInfoDiv = document.getElementById('worksheetsInfo');
    worksheetsInfoDiv.innerHTML = '';  // Clear previous content

    for (let sheetName in sheets) {
        // Display the worksheet's title and row count
        const p = document.createElement('p');
        p.textContent = 'Title: ' + sheetName + ', Row Count: ' + sheets[sheetName]['!ref'].split(':')[1].replace(/[A-Z]/g, '');
        worksheetsInfoDiv.appendChild(p);
    }
}

function PrintEntireSheet() {
    const worksheetsTestDiv = document.getElementById('worksheetsTest');
    worksheetsTestDiv.innerHTML = '';  // Clear previous content

    for (let sheetName in workbook.Sheets) {
        // Display the sheet's name
        const h3 = document.createElement('h3');
        h3.textContent = 'Sheet: ' + sheetName;
        worksheetsTestDiv.appendChild(h3);

        // Get the worksheet
        let worksheet = workbook.Sheets[sheetName];

        // Convert worksheet to JSON
        let json = XLSX.utils.sheet_to_json(worksheet, {header:1});

        // Display the contents
        json.forEach((row, index) => {
            const p = document.createElement('p');
            p.textContent = 'Row ' + (index + 1) + ': ' + row.join(', ');
            worksheetsTestDiv.appendChild(p);
        });
    }
}


async function uploadAndTest() {
    const sheets = await uploadParseXLSX();
    printInfo(sheets);
    PrintEntireSheet();
}

document.getElementById('xlsxFile').addEventListener('change', uploadAndTest);
</script>


      </section>
    </div>
  </div>

  <div style="height: 50px;">
    <p align="center"><img src="https://posetmage.com/Images/Icon/LatticeMage_t.png" Height="32" />
      <a href="/">LatticeMage</a>
      <img src="https://posetmage.com/Images/Icon/LatticeMage_t.png" Height="32" />
    </p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Fetch all the headers
      var headers = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  
      // Prepare an empty object to store our ToC
      var toc = [];
  
      // Loop over the headers
      headers.forEach(function(header, index) {
        // Skip first two headers (site title and description)
        if (index < 2) return;
  
        // Give each header an id
        var id = 'header-' + index;
        header.id = id;
  
        // Push the header to our ToC
        toc.push({
          id: id,
          text: header.innerText,
          tagName: header.tagName
        });
      });
  
      // Get the current page path and remove the file name to get the parent directory
      var path = 'AI/表格測試.md';
      var parentDirectory = path.substring(0, path.lastIndexOf('/'));
      // Remove the final character if it's a "/"
      if (parentDirectory[parentDirectory.length - 1] === "/") {
          parentDirectory = parentDirectory.substring(0, parentDirectory.length - 1);
        }
      // Add a leading '/' to ensure the link is treated as an absolute path
      if (parentDirectory[0] !== '/') {
        parentDirectory = '/' + parentDirectory;
      }

      // Prepare an empty string to build our ToC HTML
      var tocHTML = '<p><a href="' + parentDirectory + '">Previous Layer</a></p>'; // Include the link to parent directory
    
      // Loop over our ToC
      toc.forEach(function(tocItem) {
        // Add an indent based on the header level
        var indent = parseInt(tocItem.tagName.substring(1)) - 1;
  
        // Add the item to the ToC HTML
        tocHTML += '<p style="text-indent: ' + indent + 'em;"><a href="#' + tocItem.id + '">' + tocItem.text + '</a></p>';
      });
  
      // Inject our ToC into the div
      document.getElementById('toc').innerHTML = tocHTML;
    });
  </script>
</body>

</html>
